# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

trigger:
- main

pool:
  name: Vicky

steps:
- task: accuknox-sast@3
  inputs:
    accuknoxEndpoint: '$(accuknoxEndpoint)'
    accuknoxToken: '$(accuknoxToken)'
    accuknoxLabel: '$(accuknoxLabel)'
    SoftFail: false
- task: accuknox-iac@2
  inputs:
    accuknoxEndpoint: '$(accuknoxEndpoint)'
    accuknoxToken: '$(accuknoxToken)'
    accuknoxLabel: '$(accuknoxLabel)'
    inputQuiet: true
    inputCompact: true
    inputSoftFail: false

- task: AccuKnox-DAST@2
  inputs:
    targetURL: 'http://testphp.vulnweb.com/'
    scanType: 'baseline'
    qualityGate: 'Critical'
    accuknoxEndpoint: $(accuknoxEndpoint)
    accuknoxToken: $(accuknoxToken)
    accuknoxLabel: $(accuknoxLabel)
